// globals.ts
import fs from 'fs'
import sqlite3 from 'sqlite3';
import { promisify } from 'util';
import { enableDir } from './utils.js';

let initialized = false;
let ChatBookSetting = null
let db = null
let getDbRecord = null
let getDbRecordALL = null

export function initChatBookSetting(Data) {
    console.log("ChatBookSettingChatBookSetting", Data)
    ChatBookSetting = Data
}

export function ChatBookDbPool() {

    const DataDir = ChatBookSetting?.NodeStorageDirectory;
    
    if(DataDir == undefined || DataDir == null || !isDirectorySync(DataDir)) {
        return {DataDir: null, db: null, getDbRecord: null, getDbRecordALL: null}
    }

    if(db == null) {
        db = new sqlite3.Database(DataDir + '/ChatBookSqlite3.db', { encoding: 'utf8' });
    }

    if(getDbRecord == null) {
        getDbRecord = promisify(db.get.bind(db));
    }

    if(getDbRecordALL == null) {
        getDbRecordALL = promisify(db.all.bind(db));
    }

    return {DataDir, db, getDbRecord, getDbRecordALL}
}

export function ChatBookDbInit() {
  let exeStatus = 0  
  if (!initialized) {
    const { DataDir, db, getDbRecord, getDbRecordALL } = ChatBookDbPool()
    
    if(!isDirectorySync(DataDir)) {
        return {DataDir: null, db: null, getDbRecord: null, getDbRecordALL: null}
    }

    console.log("ChatBookDbInit", db, DataDir)

    enableDir(DataDir);
    enableDir(DataDir + '/audio/');
    enableDir(DataDir + '/avatarforapp/');
    enableDir(DataDir + '/avatarfordataset/');
    enableDir(DataDir + '/image/');
    enableDir(DataDir + '/imageforimage/');
    enableDir(DataDir + '/imageforvideo/');
    enableDir(DataDir + '/LanceDB/');
    enableDir(DataDir + '/uploadfiles/');
    enableDir(DataDir + '/parsedfiles/');
    enableDir(DataDir + '/video/');

    db.serialize(() => {
        db.run(`
            CREATE TABLE IF NOT EXISTS collection (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                _id TEXT not null,
                datasetId INTEGER not null,
                type TEXT not null default 'File',
                name TEXT not null default '',
                content TEXT not null default '',
                suffixName TEXT not null,
                newName TEXT UNIQUE not null,
                originalName TEXT not null,
                fileHash TEXT not null,
                trainingMode TEXT not null default '',
                processWay TEXT not null default '',
                IdealChunkLength TEXT not null default '',
                CustomSplitChar TEXT not null default '',
                status INTEGER not null default 0,
                timestamp INTEGER not null default 0,
                userId INTEGER not null,
                data TEXT not null default '',
                dataTotal TEXT not null default '',
                folder TEXT not null default '',
                updateTime TEXT not null default ''
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS logs (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                datetime TEXT not null,
                content TEXT not null,
                appId TEXT not null,
                publishId TEXT not null,
                userId TEXT not null
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS chatlog (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                _id TEXT not null,
                send TEXT not null,
                received TEXT not null,
                userId INTEGER not null default 0,
                timestamp INTEGER not null default 0,
                source TEXT not null,
                history TEXT not null,
                current INTEGER not null default 1,
                responseTime INTEGER not null default 0,
                appId TEXT not null,
                publishId TEXT not null
            );
        `);        
        db.run(`
            CREATE TABLE IF NOT EXISTS user (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                email TEXT UNIQUE not null,
                username TEXT UNIQUE not null,
                firstname TEXT not null default '',
                lastname TEXT not null default '',                
                organization TEXT not null default '',             
                role TEXT not null default 'user',
                mobile TEXT not null default '',
                address TEXT not null default '',
                state TEXT not null default '',
                zipcode TEXT not null default '',
                country TEXT not null default '',
                language TEXT not null default '',
                timezone TEXT not null default '',
                nickname TEXT not null default '',
                birthday TEXT not null default '',
                avatar TEXT not null default '',
                mobile_status INTEGER not null default 0,
                google_auth TEXT not null default '',
                github_auth TEXT not null default '',
                user_type TEXT not null default '',
                user_status INTEGER not null default 1,
                password TEXT not null default '',
                createtime INTEGER not null default 0
            );
        `);      
        db.run(`
            CREATE TABLE IF NOT EXISTS userlog (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                email TEXT not null default '',
                browsertype TEXT not null default '',
                browserversion TEXT not null default '',
                os TEXT not null default '',
                device TEXT not null default '',
                location TEXT not null default '',
                country TEXT not null default '',
                ipaddress TEXT not null default '',
                recentactivities INTEGER not null default 0,
                action TEXT not null default '',
                msg TEXT not null default ''
            );
        `);
        db.run(`insert or ignore into user (email, username, role, password, createtime) values('chatbook-admin@gmail.com', 'chatbook-admin', 'admin', '$2b$10$JWPrDnyv3v3ov3B0BuQXtOvy.rpci6RY4Cqi33kFAeDx1RfhUjN6.', '`+Date.now()+`');`);
        db.run(`insert or ignore into user (email, username, role, password, createtime) values('chatbook-user@gmail.com', 'chatbook-user', 'user', '$2b$10$JWPrDnyv3v3ov3B0BuQXtOvy.rpci6RY4Cqi33kFAeDx1RfhUjN6.', '`+Date.now()+`');`);
        db.run(`
            CREATE TABLE IF NOT EXISTS userimages (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId TEXT not null,
                email TEXT not null,
                model TEXT not null,
                prompt TEXT not null,
                negative_prompt TEXT not null,
                steps TEXT not null,
                seed TEXT not null,
                style TEXT not null,
                filename TEXT not null,
                data TEXT not null,
                date INTEGER not null default 0,
                createtime INTEGER not null default 0,
                cost_usd INTEGER not null default 0,
                cost_xwe INTEGER not null default 0,
                cost_api INTEGER not null default 0,
                orderId TEXT not null,
                orderTX TEXT not null,
                source TEXT not null,
                star INTEGER not null default 0,
                like INTEGER not null default 0,
                favorite INTEGER not null default 0,
                referee INTEGER not null default 0
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS uservideos (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId TEXT not null,
                email TEXT not null,
                model TEXT not null,
                motion INTEGER not null default 0,
                cfg_scale INTEGER not null default 0,
                seed INTEGER not null default 0,
                filename TEXT not null,
                data TEXT not null,
                date INTEGER not null default 0,
                createtime INTEGER not null default 0,
                cost_usd INTEGER not null default 0,
                cost_xwe INTEGER not null default 0,
                cost_api INTEGER not null default 0,
                orderId TEXT not null,
                orderTX TEXT not null,
                source TEXT not null,
                star INTEGER not null default 0,
                like INTEGER not null default 0,
                favorite INTEGER not null default 0,
                referee INTEGER not null default 0,
                status INTEGER not null default 0
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS userimagefavorite (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId INTEGER not null default 0,
                imageId INTEGER not null default 0,
                status INTEGER not null default 0,
                createtime INTEGER not null default 0
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS userimagelike (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId INTEGER not null default 0,
                imageId INTEGER not null default 0,
                status INTEGER not null default 0,
                createtime INTEGER not null default 0
            );
        `); 
        db.run(`
            CREATE TABLE IF NOT EXISTS uservideofavorite (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId INTEGER not null default 0,
                videoId INTEGER not null default 0,
                status INTEGER not null default 0,
                createtime INTEGER not null default 0
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS uservideolike (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId INTEGER not null default 0,
                videoId INTEGER not null default 0,
                status INTEGER not null default 0,
                createtime INTEGER not null default 0
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS app (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                _id TEXT KEY not null,
                teamId TEXT not null,
                name TEXT not null,
                intro TEXT not null,
                avatar TEXT not null,
                type TEXT not null,
                groupOne TEXT not null default '通用',
                groupTwo TEXT not null default '写作',
                permission TEXT not null,
                data TEXT not null,
                status INTEGER not null default 1,
                userId INTEGER not null default 0,
                language TEXT not null default 'en',
                createtime INTEGER not null default 0,
                UNIQUE(_id)
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS userapp (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                userId INTEGER not null default 0,
                appId INTEGER not null default 0,
                createtime INTEGER not null default 0,
                UNIQUE(userId, appId)
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS publish (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                _id TEXT KEY not null,
                appId TEXT not null,
                name TEXT not null,
                maxToken TEXT not null,
                returnReference INTEGER not null default 0,
                ipLimitPerMinute INTEGER not null default 100,
                expiredTime TEXT not null,
                authCheck TEXT not null,
                lastAccessTime TEXT not null,
                userId INTEGER not null default 0,
                language TEXT not null default 'en'
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS appchatlog (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                _id TEXT KEY not null,
                appId TEXT not null,
                name TEXT not null default '',
                source TEXT not null default '',
                time TEXT not null default '',
                totalMsg INTEGER not null default 0,
                userFeedback TEXT not null default '',
                defineFeedback TEXT not null default '',
                answerAmount INTEGER not null default 0,
                userId INTEGER not null default 0
            );
        `);
        db.run(`
            CREATE TABLE IF NOT EXISTS dataset (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                _id TEXT not null,
                teamId TEXT not null,
                name TEXT not null,
                avatar TEXT not null default '',
                type TEXT not null default '',
                vectorModel TEXT not null default '',
                singleDataUpLimit INTEGER not null default 0,
                fileDealModel TEXT not null default '',
                intro TEXT not null default '',
                permission TEXT not null default '',
                createTime TEXT not null default '',
                folder TEXT not null default '',
                userId INTEGER not null,
                syncStatus INTEGER not null default 0
            );
        `);

        
        db.run(`
        INSERT INTO app ("_id",teamId,name,intro,avatar,"type",groupOne,groupTwo,permission,"data",status,userId,"language",createtime) VALUES
        ('zSz1hyBY9TypGf7tEwewsGjQ1febMn6z','zSz1hyBY9TypGf7tEwewsGjQ1febMn6z','ChatGPT','一个极其简单的 AI 应用，你可以绑定知识库或工具。','avatar-1717138944759-275529810.png','simpleChat','','','public','{"_id":"zSz1hyBY9TypGf7tEwewsGjQ1febMn6z","teamId":"zSz1hyBY9TypGf7tEwewsGjQ1febMn6z","id":"zSz1hyBY9TypGf7tEwewsGjQ1febMn6z","name":"ChatGPT","avatar":"avatar.png","intro":"一个极其简单的 AI 应用，你可以绑定知识库或工具。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"AudioBrowser","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229},"width":500,"height":466},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350},"width":500,"height":198},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"gpt-3.5-turbo","LLMModel":{"LLMModelOpen":false,"model":"gpt-3.5-turbo","name":"Chatgpt-3.5","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720},"width":584,"height":844}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:02:24 PM","groupTwo":""}',1,1,'',1717138782627),
        ('kidwyayj2pYDz2kq5qdrvrJSf6jkbQvU','kidwyayj2pYDz2kq5qdrvrJSf6jkbQvU','DeepSeek','一个极其简单的 AI 应用，你可以绑定知识库或工具。','avatar-1717138928326-653658304.png','simpleChat','','','public','{"_id":"kidwyayj2pYDz2kq5qdrvrJSf6jkbQvU","teamId":"kidwyayj2pYDz2kq5qdrvrJSf6jkbQvU","id":"kidwyayj2pYDz2kq5qdrvrJSf6jkbQvU","name":"DeepSeek","avatar":"avatar-1717138928326-653658304.png","intro":"一个极其简单的 AI 应用，你可以绑定知识库或工具。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:18:04 PM","groupTwo":""}',1,1,'',1717138904737),
        ('j3RnARXIbYZ42iiQT37gtJ9rL67Wpsgp','j3RnARXIbYZ42iiQT37gtJ9rL67Wpsgp','英语作文助手','英语作文修改与写作指导','avatar-1717139015677-254853111.jpg','simpleChat','','','public','{"_id":"j3RnARXIbYZ42iiQT37gtJ9rL67Wpsgp","teamId":"j3RnARXIbYZ42iiQT37gtJ9rL67Wpsgp","id":"j3RnARXIbYZ42iiQT37gtJ9rL67Wpsgp","name":"英语作文助手","avatar":"avatar-1717139015677-254853111.jpg","intro":"英语作文修改与写作指导","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"AudioBrowser","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"# Character\n\n你是一个专门用于修改和指导英语作文的 AI 助手，擅长使用高级的英语句式进行写作指导。\n\n## Skills\n\n### 技能 1：英语作文修改\n\n- 检查用户的英语作文，发现语法错误、拼写错误和语句不通顺的地方。\n- 根据错误类型提供修改建议。\n\n### 技能 2：英语作文写作指导\n\n- 根据用户的写作需求，提供相应的高级英语句式和表达方式。\n- 对用户的写作风格进行指导和改善。\n\n### 技能 3：提供写作素材\n\n- 根据用户的作文题目，提供相关的写作素材和论据。\n- 这些素材可以帮助用户丰富作文内容，提高作文质量。\n\n## 限制条件：\n\n- 只讨论与英语作文相关的主题。\n- 坚持使用规定的输出格式。\n- 以 Markdown 格式引用来源。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:17:47 PM","groupTwo":""}',1,1,'',1717138974866),
        ('NJ0Bv51XkXfG9eiZFkQx91uIm0PzdpiB','NJ0Bv51XkXfG9eiZFkQx91uIm0PzdpiB','软件开发入门指南','《软件开发入门指南》：指导初学者通过软件开发过程，提供逐步指导和最佳实践，包括需求收集、设计、编码、测试、部署和维护。','avatar-1717139625754-281986485.jpg','simpleChat','','','public','{"_id":"NJ0Bv51XkXfG9eiZFkQx91uIm0PzdpiB","teamId":"NJ0Bv51XkXfG9eiZFkQx91uIm0PzdpiB","id":"NJ0Bv51XkXfG9eiZFkQx91uIm0PzdpiB","name":"软件开发入门指南","avatar":"avatar-1717139625754-281986485.jpg","intro":"《软件开发入门指南》：指导初学者通过软件开发过程，提供逐步指导和最佳实践，包括需求收集、设计、编码、测试、部署和维护。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"AudioBrowser","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"## 角色：\n\n您是一名多模式软件开发指南，负责指导用户，即所谓的初学者，通过结构化的软件开发过程。您的角色是概述创建软件的各个阶段，从最初概念到最终部署和维护，确保用户理解每个阶段及其在整个开发生命周期中的重要性。\n\n## 能力：\n\n- 提供软件开发过程的逐步分解，包括需求收集、设计、编码、测试、部署和维护。\n- 提供每个开发阶段的最佳实践指导，如敏捷方法、版本控制和持续集成/持续部署（CI/CD）实践。\n- 帮助初学者理解参与软件开发过程的每个团队成员的角色和责任。\n- 建议可以促进开发不同阶段的工具和资源，如项目管理软件、开发框架和测试套件。\n\n## 指南：\n\n- 从软件开发生命周期（SDLC）的概述开始，为后续步骤奠定基础。\n- 强调在进入设计阶段之前充分理解用户需求的重要性。\n- 指导用户创建详细的软件设计文档（SDD），解释系统架构和用户界面设计的重要性。\n- 指导编码最佳实践，包括编写清晰、可维护的代码和遵守编码标准。\n- 强调严格的测试的必要性，包括单元测试、集成测试和用户验收测试（UAT）。\n- 解释部署过程，包括准备部署环境和使用自动化部署工具。\n- 讨论部署后活动的重要性，如监控、用户反馈收集和未来发布的迭代开发。\n\n作为软件开发步骤制作者，您的使命是确保用户充分了解软件开发的每个阶段，使他们具备管理和有效贡献软件项目的知识。您的指导应帮助用户应对软件创建的复杂性，并在整个开发过程中保持高标准的质量。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:17:30 PM","groupTwo":""}',1,1,'',1717139037425),
        ('btsmOXmKkpeVIGVD2w8zN5qjU1sxm6aF','btsmOXmKkpeVIGVD2w8zN5qjU1sxm6aF','面试教练','专注于创建用于练习和模拟面试的 GPT 面试教练，提供专家反馈和定制体验。','avatar-1717139615449-792449488.png','simpleChat','','','public','{"_id":"btsmOXmKkpeVIGVD2w8zN5qjU1sxm6aF","teamId":"btsmOXmKkpeVIGVD2w8zN5qjU1sxm6aF","id":"btsmOXmKkpeVIGVD2w8zN5qjU1sxm6aF","name":"面试教练","avatar":"avatar-1717139615449-792449488.png","intro":"专注于创建用于练习和模拟面试的 GPT 面试教练，提供专家反馈和定制体验。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"#### GPT 人物：\n\n- 该 GPT 作为面试教练，通过进行练习面试和模拟面试来协助用户。\n- 面试教练在提供反馈时利用最佳实践，如 STAR 方法\n- 面试教练在面试过程中扮演面试官的角色\n- 面试教练扮演的角色专业且熟练\n- 面试教练始终以友好的方式提供批判性反馈\n- 面试教练措辞简洁\n\n#### 开始对话指南：\n\n开始对话时，面试教练将始终要求用户提供以下信息，以便提供定制和个性化的体验。面试教练每次只会问一个问题。\n\n1.  要求用户通过上传或将内容粘贴到聊天中来提供其简历\n2.  要求用户通过上传或将内容粘贴到聊天中来提供其所面试的工作描述或角色\n3.  根据用户所面试的角色要求用户选择要进行的面试类型（例如，行为面试、技术面试等）\n4.  要求用户提供面试官的角色（例如，产品总监）；如果提供了角色，则扮演该角色\n5.  要求用户告知希望进行的问题数量。最多 10 个问题。\n6.  要求用户选择面试模式：\n\n- 练习面试模式：在练习模式下，面试教练将在提问后等待用户的回答，然后对用户的回答进行反馈。在所有问题结束后总结反馈。\n- 模拟面试模式：在模拟面试模式下，面试教练将问用户一个问题，等待回答，然后问下一个问题。在所有问题结束后总结面试并提供反馈。\n\n7.  面试教练将在进行下一个问题之前每次只会问一个问题\n\n#### 提供反馈：\n\n1.  当面试教练提供反馈时，始终根据用户所面试的角色使用最佳实践\n2.  面试结束后，面试教练始终提供详细的反馈\n3.  在适当的情况下，面试教练将提供用户如何重新构思回答的示例\n4.  面试教练提供反馈时始终使用清晰的结构\n5.  面试教练提供反馈时将始终给出 0 - 10 分的评分并附上评分理由","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:17:11 PM","groupTwo":""}',1,1,'',1717139081935),
        ('cebbPe0gaTvNgsFa0KoWYuwYijS3MXfX','cebbPe0gaTvNgsFa0KoWYuwYijS3MXfX','C1 级别的英语会话伙伴','C1 级别的英语会话伙伴','avatar-1717139589004-579665220.jpg','simpleChat','','','public','{"_id":"cebbPe0gaTvNgsFa0KoWYuwYijS3MXfX","teamId":"cebbPe0gaTvNgsFa0KoWYuwYijS3MXfX","id":"cebbPe0gaTvNgsFa0KoWYuwYijS3MXfX","name":"C1 级别的英语会话伙伴","avatar":"avatar-1717139589004-579665220.jpg","intro":"C1 级别的英语会话伙伴","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"C1级别角色：\n您是C1级别的英语会话伙伴，旨在与具有熟练的英语掌握能力的个人进行互动。您的角色是促进推动用户语言技能边界的对话，侧重于复杂情境中的有效表达、微妙语言细微差别的掌握以及能够深入讨论专业话题的能力。\n\nC1级别的能力：\n进行复杂、抽象或专业主题的复杂讨论，如学术课题、专业领域和高级文化概念。\n支持用户细化对微妙语言的理解和使用，包括高级习语表达。\n指导用户完善高级语法结构和文体语言特征。\n帮助扩展用户的词汇量，包括广泛的精确和特定上下文的术语。\n就用户的语言表达提供精确而有见地的反馈，包括提高流利度、连贯性和风格的建议。\nC1级别的指导方针：\n鼓励用户清晰而连贯地阐述复杂的观点，具有良好结构的推理和支持。\n讨论需要分析技能和深入知识的话题，使用户展示他们对语言的掌握。\n提供有助于用户为不同交际目的和受众精炼其语言选择的微妙反馈。\n促进使用高级语言特征，如倒装、强调句和调制，以传达更细微的意义。\n挑战用户在各种情境中理解和产生高度准确和适当的语言。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:16:56 PM","groupTwo":""}',1,1,'',1717139107715),
        ('lI7fWo17rRO4ZbZvVAMHmqlYxU5BrzEB','lI7fWo17rRO4ZbZvVAMHmqlYxU5BrzEB','软件开发步骤制定者','软件开发步骤制定者：指导用户完成软件开发过程，提供需求收集、设计、编码、测试、部署和维护的逐步说明和最佳实践。','avatar-1717139564487-253823709.jpg','simpleChat','','','public','{"_id":"lI7fWo17rRO4ZbZvVAMHmqlYxU5BrzEB","teamId":"lI7fWo17rRO4ZbZvVAMHmqlYxU5BrzEB","id":"lI7fWo17rRO4ZbZvVAMHmqlYxU5BrzEB","name":"软件开发步骤制定者","avatar":"avatar-1717139564487-253823709.jpg","intro":"软件开发步骤制定者：指导用户完成软件开发过程，提供需求收集、设计、编码、测试、部署和维护的逐步说明和最佳实践。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"## 角色：\n\n您是一名软件开发步骤制定者，负责指导用户完成软件开发的结构化过程。您的角色是概述创建软件的各个阶段，从最初的概念到最终部署和维护，确保用户理解每个阶段及其在整个开发生命周期中的重要性。\n\n## 能力：\n\n- 提供软件开发过程的逐步分解，包括需求收集、设计、编码、测试、部署和维护。\n- 提供每个开发阶段的最佳实践指导，如敏捷方法、版本控制和持续集成/持续部署（CI/CD）实践。\n- 帮助用户理解参与软件开发过程的每个团队成员的角色和责任。\n- 建议可以促进开发不同阶段的工具和资源，如项目管理软件、开发框架和测试套件。\n\n## 指南：\n\n- 从软件开发生命周期（SDLC）的概述开始，为后续步骤奠定基础。\n- 强调在进入设计阶段之前充分了解用户需求的重要性。\n- 指导用户创建详细的软件设计文档（SDD），解释系统架构和用户界面设计的重要性。\n- 指导编码最佳实践，包括编写清晰、可维护的代码和遵守编码标准。\n- 强调严格的测试必要性，包括单元测试、集成测试和用户验收测试（UAT）。\n- 解释部署过程，包括准备部署环境和使用自动化部署工具。\n- 讨论部署后活动的重要性，如监控、用户反馈收集和未来发布的迭代开发。\n\n作为一名软件开发步骤制定者，您的使命是确保用户充分了解软件开发的每个阶段，为他们提供管理和有效贡献软件项目的知识。您的指导应帮助用户应对软件创建的复杂性，并在整个开发过程中保持高质量标准。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:16:37 PM","groupTwo":""}',1,1,'',1717139144604),
        ('O0KanJCojPjOaa0quebvQh1xXgsCRY7F','O0KanJCojPjOaa0quebvQh1xXgsCRY7F','A2 英语会话辅导员','A2 级别英语会话伙伴机器人：提升基础英语学习者的语言能力。','avatar-1717139517494-603924764.jpg','simpleChat','','','public','{"_id":"O0KanJCojPjOaa0quebvQh1xXgsCRY7F","teamId":"O0KanJCojPjOaa0quebvQh1xXgsCRY7F","id":"O0KanJCojPjOaa0quebvQh1xXgsCRY7F","name":"A2 英语会话辅导员","avatar":"avatar-1717139517494-603924764.jpg","intro":"A2 级别英语会话伙伴机器人：提升基础英语学习者的语言能力。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"角色：\n您是一名A2级别英语会话伙伴机器人，旨在协助具有基础英语知识并希望进一步提高语言能力的个人。您的角色包括促进略微复杂于A1级别的对话，纠正语言错误，并帮助扩展适合A2学习者的词汇和语法理解。\n\n能力：\n进行更广泛的话题对话，包括个人兴趣、日常例行和简单观点。\n纠正用户的错误，重点是改善句子结构和动词时态的使用。\n介绍和强化与A2级别熟练度相关的词汇和表达。\n为语法结构提供解释和情境示例。\n鼓励用户进行更长的讲话并使用更具描述性的语言。\n指南：\n通过提问引导用户进行超过是/否回答的对话，刺激交流。\n用完整的句子讲话，并介绍常见的动词短语和习语表达。\n提供具体和即时的反馈，但优先考虑流利性，以保持对话流畅。\n通过提示用户思考表达其想法的替代方式，鼓励自我纠正。\n提供涉及在语境中形成问题和使用过去、现在和将来动词时态的练习。\n使用角色扮演或假设情境帮助用户练习不同场景的语言。\n根据用户的舒适程度和技能水平提供更多或更少的支持，灵活调整您的方法。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:16:11 PM","groupTwo":""}',1,1,'',1717139214871),
        ('hW4kp2vYI67WpysveD5qLvs59jyNYal9','hW4kp2vYI67WpysveD5qLvs59jyNYal9','歌曲创作导师','AI 歌手 / 词曲创作助手：为音乐人提供创意指导和反馈。','avatar-1717139460074-766048100.png','simpleChat','','','public','{"_id":"hW4kp2vYI67WpysveD5qLvs59jyNYal9","teamId":"hW4kp2vYI67WpysveD5qLvs59jyNYal9","id":"hW4kp2vYI67WpysveD5qLvs59jyNYal9","name":"歌曲创作导师","avatar":"avatar-1717139460074-766048100.png","intro":"AI 歌手 / 词曲创作助手：为音乐人提供创意指导和反馈。","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"角色：\n您是一名AI歌手/词曲创作助手，旨在支持初学者和经验丰富的音乐人进行创作。您的角色包括提供关于词曲创作、旋律创作、歌词创作的指导，并对用户生成的内容提供反馈。您具备对各种流派的音乐理论、歌曲结构和歌词创作的全面理解。\n\n能力：\n根据用户输入生成词曲创作的提示和想法。\n为歌词创作建议押韵词、同义词和短语。\n对用户创作的歌词和旋律提供建设性反馈。\n提供关于歌曲结构（包括诗句、副歌、过渡等）的建议。\n协助旋律和和弦进行创作。\n分享词曲创作的最佳实践和常见陷阱。\n推荐进一步学习和提高词曲创作的资源。\n分析著名歌曲以说明词曲创作技巧。\n指南：\n通过提供灵感鼓励用户的创造力，而不是过于规定性地指导。\n提供支持性和建设性的反馈，侧重于可以改进的具体要素。\n避免为用户创作整首歌曲；而是赋予他们发展技能的能力。\n保持尊重和鼓励的语气，认识到词曲创作的个人性质。\n在讨论音乐理论时，提供尽可能简单或复杂的解释，以符合用户的理解水平。\n确保对旋律和和弦的建议与用户的音乐偏好和风格相容。\n尊重用户作品的独创性，未经允许不分享他们的歌词或旋律。\n澄清，虽然您可以协助词曲创作的许多方面，但现场表演技巧和声乐指导超出您的范围。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:15:47 PM","groupTwo":""}',1,1,'',1717139269830),
        ('1Ta4xk6wN8mvtS73iM8PuEM8SwfYOBeY','1Ta4xk6wN8mvtS73iM8PuEM8SwfYOBeY','文本总结助手','擅长准确提取关键信息并简洁总结','avatar-1717139447617-265036510.jpg','simpleChat','','','public','{"_id":"1Ta4xk6wN8mvtS73iM8PuEM8SwfYOBeY","teamId":"1Ta4xk6wN8mvtS73iM8PuEM8SwfYOBeY","id":"1Ta4xk6wN8mvtS73iM8PuEM8SwfYOBeY","name":"文本总结助手","avatar":"avatar-1717139447617-265036510.jpg","intro":"擅长准确提取关键信息并简洁总结","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"## 角色：\n\n你是一款专业的文本总结助手。你的主要任务是从用户提供的长段落中提取关键信息，并专注于准确地总结段落的大意，而不包含任何其他多余的信息或解释。\n\n## 能力：\n\n- 从长段落中识别并提取关键信息。\n- 将提取的信息准确地总结为一段简洁的文本。\n\n## 指南：\n\n- 当用户提供长段落时，首先阅读并理解其中的内容。确定主题，找出关键信息。\n- 在总结大意时，只包含关键信息，尽量减少非主要信息的出现。\n- 总结的文本要简洁明了，避免任何可能引起混淆的复杂语句。\n- 完成总结后，立即向用户提供，不需要询问用户是否满意或是否需要进一步的修改和优化。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:15:18 PM","groupTwo":""}',1,1,'',1717139296451);
        `);
        
        db.run(`
        INSERT INTO app ("_id",teamId,name,intro,avatar,"type",groupOne,groupTwo,permission,"data",status,userId,"language",createtime) VALUES
        ('fiIYr3R7Wdd0yiJ8gf93rHT94uUlCapo','fiIYr3R7Wdd0yiJ8gf93rHT94uUlCapo','雅思导师','擅长雅思考试评估与指导','avatar-1717139426205-690406013.jpg','simpleChat','','','public','{"_id":"fiIYr3R7Wdd0yiJ8gf93rHT94uUlCapo","teamId":"fiIYr3R7Wdd0yiJ8gf93rHT94uUlCapo","id":"fiIYr3R7Wdd0yiJ8gf93rHT94uUlCapo","name":"雅思导师","avatar":"avatar.png","intro":"擅长雅思考试评估与指导","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"gpt-3.5-turbo","LLMModel":{"LLMModelOpen":false,"model":"gpt-3.5-turbo","name":"Chatgpt-3.5","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"## 角色：\n\n您与一位专业的雅思考官进行互动，此考官具备国际英语语言测试系统（IELTS）考试的全面知识，并能够在口语和写作部分为您提供专业的指导和评估。考官能够根据雅思评分标准对您的英语水平进行准确评估，并给出具体的提高建议。\n\n## 能力：\n\n- 详细解析雅思考试的评分标准。\n- 提供针对口语和写作部分的个性化反馈。\n- 模拟真实的雅思考试环境进行练习。\n- 给出提升英语水平的策略和资源。\n- 使用 STAR 等方法对口语部分提供结构化反馈。\n- 遵循语言标准，确保提供的建议和反馈符合雅思要求。\n\n## 指南：\n\n1.  **了解需求**：请提供您希望专注的雅思考试部分（口语或写作），以及您当前的英语水平和目标分数。\n\n2.  **模拟练习**：我们将模拟考试场景，您可以选择进行一次完整的口语模拟测试或提交一篇写作作文。\n\n3.  **详细反馈**：考官将根据您的表现提供详细的评价，包括您的优点和需要改进的地方。\n\n4.  **改进策略**：根据评价结果，考官会提供针对性的建议和练习，帮助您提高相应技能。\n\n5.  **资源推荐**：您将获得雅思学习材料的推荐，包括书籍、在线课程和练习材料。\n\n6.  **定期评估**：如果需要，我们可以安排定期的跟进会话，以监测您的进步并更新学习计划。\n\n请注意，此交互专注于雅思考试的准备，不包括实际的考试评分服务或考试报名流程。如需了解更多关于雅思的信息，请访问官方雅思网站。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:10:26 PM","groupTwo":""}',1,1,'',1717139322075),
        ('c4Ct1oEmiHEvFmI26LSPeNf3Xb710glf','c4Ct1oEmiHEvFmI26LSPeNf3Xb710glf','周报助手','我是周报生成助手','avatar-1717139406636-591568355.png','simpleChat','','','public','{"_id":"c4Ct1oEmiHEvFmI26LSPeNf3Xb710glf","teamId":"c4Ct1oEmiHEvFmI26LSPeNf3Xb710glf","id":"c4Ct1oEmiHEvFmI26LSPeNf3Xb710glf","name":"周报助手","avatar":"avatar-1717139406636-591568355.png","intro":"我是周报生成助手","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"welcomeTextInitial"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"deepseek","LLMModel":{"LLMModelOpen":true,"model":"deepseek","name":"Deepseek","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"请担任周报总结生成助手，你是一位专业的文案编辑，负责将客户提供的工作内容高效地转换为一篇结构清晰、语言流畅的周报。助手注重使信息准确传达，同时确保文本易于阅读，适合所有受众群体。\n\n### 专长\n\n- 数据整理与分析：梳理并分析用户提供的原始数据和信息。\n- 内容撰写与润色：将信息转化为连贯、清晰的文本，并进行必要的文风调整。\n- 结构优化：确保周报内容逻辑清晰，便于快速把握重点。\n\n### 规则\n\n- 保持信息的准确性和完整性。\n- 确保文本通顺，语言简洁明了。\n- 遵循客户指定的格式和风格要求。\n\n### 流程\n\n- 收集用户提供的工作内容和数据。\n- 分析并整理关键信息，构建周报框架。\n- 撰写并润色周报内容，确保逻辑性和可读性。\n- 根据需要对周报进行最终的格式调整和优化。","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 3:14:03 PM","groupTwo":""}',1,1,'',1717139348596),
        ('dDnuriroO2ZC4Y3t2aN3Cj52jewncu4u','dDnuriroO2ZC4Y3t2aN3Cj52jewncu4u','数字校园','加载单点数字化校园的介绍和河南省数字化校园标准的网页信息','avatar-1717142518061-466359687.png','simpleChat','','','public','{"_id":"dDnuriroO2ZC4Y3t2aN3Cj52jewncu4u","teamId":"dDnuriroO2ZC4Y3t2aN3Cj52jewncu4u","id":"dDnuriroO2ZC4Y3t2aN3Cj52jewncu4u","name":"数字校园","avatar":"avatar-1717142518061-466359687.png","intro":"加载单点数字化校园的介绍和河南省数字化校园标准的网页信息","type":"simpleChat","mode":"simple","modules":[{"id":"userGuideNodeInitial_1","type":"userGuide","data":{"id":"userGuideNodeInitial_1","templateType":"userGuide","flowType":"userGuide","avatar":"/imgs/module/userGuide.png","name":"System Setting","intro":"userGuideTip","inputs":[{"key":"WelcomeText","type":"hidden","valueType":"string","label":"WelcomeText","showTargetInApp":false,"showTargetInPlugin":false,"value":"你好，我是知识库助手，请不要忘记选择知识库噢~\n[你是谁]\n[什么是数字校园]"},{"key":"Variables","type":"hidden","valueType":"any","label":"ModuleVariable","value":[],"showTargetInApp":false,"showTargetInPlugin":false},{"key":"QuestionGuide","valueType":"boolean","type":"switch","value":true,"label":"QuestionGuide","showTargetInApp":false,"showTargetInPlugin":false},{"key":"TTS","type":"hidden","valueType":"any","label":"Tts","value":"Disabled","speed":1,"showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[],"moduleId":"userGuide"},"position":{"x":454.98510354678695,"y":721.4016845336229}},{"id":"questionInputNodeInitial_1","type":"questionInput","data":{"id":"questionInputNodeInitial_1","templateType":"SystemInput","flowType":"questionInput","avatar":"/imgs/module/userChatInput.svg","name":"Chat entrance","intro":"userChatInputIntro","inputs":[{"key":"userChatInput","type":"SystemInput","valueType":"string","label":"user question","showTargetInApp":false,"showTargetInPlugin":false}],"outputs":[{"key":"questionInputNodeInitial_1_output","label":"user question","type":"source","valueType":"string","targets":[{"moduleId":"Targets***moduleId","key":"Targets***key"}]}],"moduleId":"questionInputNodeInitial_1_moduleId"},"position":{"x":450,"y":1350}},{"id":"chatNodeInitial_1","type":"chatNode","data":{"id":"chatNodeInitial_1","templateType":"textAnswer","flowType":"chatNode","avatar":"/imgs/module/AI.png","name":"AI Chat","intro":"AI Model Chat","showStatus":true,"isTool":true,"inputs":[{"key":"AiModel","type":"AiModel","label":"AiModel","required":true,"valueType":"string","showTargetInApp":false,"showTargetInPlugin":false,"value":"gpt-3.5-turbo","LLMModel":{"LLMModelOpen":false,"model":"gpt-3.5-turbo","name":"Chatgpt-3.5","quoteMaxToken":2,"maxContext":16000,"functionCall":true,"temperature":0,"maxResponse":4000,"maxChatHistories":6,"charsPointsPrice":2}},{"key":"systemPrompt","type":"Textarea","max":3000,"valueType":"string","value":"加载单点数字化校园的介绍和河南省数字化校园标准的网页信息","label":"NodeChatPrompt","description":"chatNodeSystemPromptTip","placeholder":"chatNodeSystemPromptTip","showTargetInApp":true,"showTargetInPlugin":true},{"key":"history","type":"NumberInput","label":"chat history","required":true,"min":0,"max":30,"valueType":"chatHistory","value":6,"showTargetInApp":true,"showTargetInPlugin":true},{"key":"userChatInput","type":"SystemInput","label":"","required":true,"valueType":"string","showTargetInApp":true,"showTargetInPlugin":true,"toolDescription":"user question"},{"key":"Dataset","type":"Dataset","label":"KnowledgeBaseRef","description":"Input description","valueType":"datasetQuote","showTargetInApp":true,"showTargetInPlugin":true,"MyDataSet":{"MyDatasetOpen":true,"MyDatasetList":[{"name":"数字校园","value":"pGxe8P1q94lS6GsnBFGdPXmcUjklFh1Z"}]},"DatasetPrompt":{"REPHRASE_TEMPLATE":"重新表述后续问题，使其成为一个独立的询问，保持原始语言。您将会收到一段对话历史和一个后续问题。\n\n说明：\n1. 请查看以下提供的对话，包括用户和AI的消息。\n2. 检查对话中包含的后续问题。\n3. 重新构建后续问题，使其能够独立存在，不需要依赖于先前对话的上下文。确保保持与原始语言相同。\n\n对话：\n###\n{chatHistory}\n###\n\n用户的后续问题：\n###\n{input}\n###\n\n您的回答：","QA_TEMPLATE":"您是一位专业的研究员。使用以下上下文片段来回答最后的问题。\n如果您不知道答案，只需说不知道。请不要编造答案。\n如果问题与上下文或聊天历史无关，请礼貌地回答您只回答与上下文相关的问题。\n\n<context>\n{context}\n</context>\n\n<chatHistory>\n{chatHistory}\n</chatHistory>\n\n问题：{input}\n以 Markdown 格式提供有帮助的回答：","DatasetPromptOpen":true}},{"key":"AiSettings","type":"AiSettings","label":"","valueType":"any","showTargetInApp":false,"showTargetInPlugin":false,"connected":false}],"outputs":[{"key":"answerText","label":"Ai response content","description":"Ai response content","valueType":"string","type":"source","targets":[]},{"key":"finish","label":"","description":"","valueType":"boolean","type":"hidden","targets":[]},{"key":"history","label":"New context","description":"New context","valueType":"chatHistory","type":"source","targets":[]},{"key":"userChatInput","label":"user question","type":"hidden","valueType":"string","targets":[]}],"moduleId":"chatModule"},"position":{"x":1150.8317145593148,"y":720}}],"edges":[{"id":"bmf6r1","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"userChatInput_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}},{"id":"bmf6r2","source":"questionInputNodeInitial_1","sourceHandle":"userChatInput","target":"chatNodeInitial_1","targetHandle":"systemPrompt_Left","type":"buttonedge","animated":true,"style":{"stroke":"#00BFFF","strokeWidth":4}}],"permission":"public","teamTags":[],"updateTime":"5/31/2024, 4:09:56 PM","groupTwo":""}',1,5098,'',1717141774007);
        `);
        
    });

    initialized = true;
    exeStatus = 1
  }
  console.log("ChatBookDbInit exeStatus", exeStatus)
  console.log("ChatBookDbInit initialized", initialized)
}

function isDirectorySync(path) {
    try {
        if(path == undefined || path == null) {
            return false
        }
        const stats = fs.statSync(path);
        return stats.isDirectory();
    } catch (err) {
        console.error('isDirectorySync Error checking if path is a directory:', err);
        return false;
    }
  }